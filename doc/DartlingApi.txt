
abstract class RepoApi {

  abstract add(DomainModelsApi domainModels);
  abstract Domains get domains();
  abstract DomainModelsApi getDomainModels(String domainCode);

}

abstract class DomainModelsApi implements SourceOfActionReactionApi {

  abstract add(ModelEntriesApi modelEntries);
  abstract Domain get domain();
  abstract ModelEntriesApi getModelEntries(String modelCode);
  abstract DomainSessionApi newSession();

}

abstract class DomainSessionApi {

  abstract DomainModelsApi get domainModels();
  abstract PastApi get past();

}

abstract class ModelEntriesApi {

  abstract Map<String, EntitiesApi> newEntries();
  abstract Model get model();
  abstract EntitiesApi getEntry(String entryConceptCode);

}

abstract class EntitiesApi<T extends EntityApi<T>> implements Iterable<T> {

  abstract EntitiesApi<T> newEntities();
  abstract Concept get concept();
  abstract EntitiesApi<T> get source();
  abstract ErrorsApi get errors();
  abstract int get count();
  abstract bool get empty();

  abstract bool preAdd(T entity);
  abstract bool add(T entity);
  abstract bool preRemove(T entity);
  abstract bool remove(T entity);

  abstract void forEach(Function f);
  abstract bool every(Function f);
  abstract bool some(Function f);

  abstract bool contains(T entity);
  abstract T last();
  abstract T find(Oid oid);
  abstract T findByCode(String code);
  abstract T findById(IdApi id);
  abstract T findByAttributeId(String code, Object attribute);
  abstract T findByAttribute(String code, Object attribute);

  abstract EntitiesApi<T> select(Function f);
  abstract EntitiesApi<T> selectByParent(String code, Object parent);
  abstract EntitiesApi<T> selectByAttribute(String code, Object attribute);
  abstract EntitiesApi<T> order();
  abstract EntitiesApi<T> orderByFunction(Function f);

  abstract void clear();
  abstract EntitiesApi<T> copy();
  abstract List<T> get list();

}

abstract class EntityApi<T extends EntityApi<T>> implements Comparable {

  abstract EntityApi<T> newEntity();
  abstract Concept get concept();
  abstract Oid get oid();
  abstract String get code();
  abstract void set code(String code);

  abstract Object getAttribute(String name);
  abstract bool setAttribute(String name, Object value);
  abstract String getStringFromAttribute(String name);
  abstract bool setStringToAttribute(String name, String string);
  abstract EntityApi getParent(String name);
  abstract bool setParent(String name, EntityApi entity);
  abstract EntitiesApi getChild(String name);
  abstract bool setChild(String name, EntitiesApi entities);

  abstract IdApi get id();
  abstract T copy();
  abstract bool equalOids(T entity);
  abstract bool equals(Object other);

}

abstract class IdApi implements Comparable, Hashable {

  abstract Concept get concept();

  abstract int get parentCount();
  abstract int get attributeCount();
  abstract int get count();

  abstract EntityApi getParent(String code);
  abstract setParent(String code, EntityApi parent);

  abstract Object getAttribute(String code);
  abstract setAttribute(String code, Object attribute);

  abstract bool equalParents(IdApi id);
  abstract bool equalAttributes(IdApi id);
  abstract bool equals(Object other);

  abstract int compareParents(IdApi id);
  abstract int compareAttributes(IdApi id);

}

abstract class ErrorsApi {

  abstract int get count();
  abstract List<Error> get list();
  abstract add(Error error);
  abstract clear();

}

abstract class ActionApi {

  abstract bool doit();
  abstract bool undo();
  abstract bool redo();

}

abstract class TransactionApi extends ActionApi {

  abstract add(ActionApi action);

}

abstract class PastApi implements SourceOfPastReactionApi {

  abstract add(ActionApi action);
  abstract clear();
  abstract bool get empty();
  abstract bool doit();
  abstract bool undo();
  abstract bool redo();
  abstract bool doAll();
  abstract bool undoAll();
  abstract bool redoAll();

}

abstract class SourceOfActionReactionApi {

  abstract startActionReaction(ActionReactionApi reaction);
  abstract cancelActionReaction(ActionReactionApi reaction);
  abstract notifyActionReactions(ActionApi action);
}

abstract class SourceOfPastReactionApi {

  abstract startPastReaction(PastReactionApi reaction);
  abstract cancelPastReaction(PastReactionApi reaction);
  abstract notifyNoPast();
  abstract notifyYesPast();
}

abstract class ActionReactionApi {

  abstract react(ActionApi action);
}

abstract class PastReactionApi {

  abstract reactNoPast();
  abstract reactYesPast();
}

